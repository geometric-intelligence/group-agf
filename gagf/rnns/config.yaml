# ============================================================================
# Base Configuration File
# ============================================================================
# This config supports both 1D and 2D modular addition tasks with either
# QuadraticRNN or SequentialMLP models.
#
# Quick Setup Guide:
# ------------------
# 1D Task (C_p):           Set dimension=1, specify p
# 2D Task (C_p1 x C_p2):   Set dimension=2, specify p1 and p2
# QuadraticRNN:            Set model_type='QuadraticRNN'
# SequentialMLP:           Set model_type='SequentialMLP'
# ============================================================================

# Data Configuration
# ------------------
data:
  # Dimension: 1 for C_p (cyclic group), 2 for C_p1 x C_p2 (product group)
  dimension: 2  # 1 | 2
  
  # Group Parameters
  # For dimension=1: only 'p' is used
  # For dimension=2: 'p1' and 'p2' are used
  p: 100        # Cyclic group dimension (1D only)
  
  p1: 10        # Height/rows dimension (2D only)
  p2: 10        # Width/cols dimension (2D only)
  
  k: 4          # Sequence length
  batch_size: 1000
  seed: 5
  
  # Template Generation
  template_type: 'mnist'    # 'mnist' | 'fourier' | 'gaussian'
  mnist_label: 4            # MNIST digit (0-9), only if template_type='mnist'
  n_freqs: 10               # Number of Fourier modes, only if template_type='fourier'
  
  # Dataset Mode (offline training only)
  mode: sampled             # 'sampled' | 'exhaustive'
  num_samples: 100000

# Model Configuration
# -------------------
model:
  model_type: 'QuadraticRNN'  # 'QuadraticRNN' | 'SequentialMLP'
  
  hidden_dim: 36              # Hidden layer size
                              # Note: SequentialMLP may need larger values (e.g., 600)
  
  init_scale: 1.0e-2          # Weight initialization scale
                              # Larger k may need larger init_scale
  
  return_all_outputs: false   # true = seq-to-seq guidance
                              # false = seq-to-one (final output only)
  
  transform_type: 'quadratic' # 'quadratic' | 'multiplicative'
                              # Only used for QuadraticRNN

# Training Configuration
# ----------------------
training:
  mode: 'online'              # 'online' | 'offline'
  
  # Steps/Epochs
  epochs: 200                 # Used when mode='offline'
  num_steps: 500000           # Used when mode='online'
  
  # Optimizer
  optimizer: 'auto'           # 'auto' | 'adam' | 'hybrid' | 'per_neuron'
                              # 'auto' selects optimizer based on model:
                              #   - SequentialMLP → 'per_neuron' (recommended)
                              #   - QuadraticRNN → 'adam'
                              # 'hybrid' is QuadraticRNN-specific only
  
  learning_rate: 1.0e-3       # Base learning rate
                              # Recommended settings:
                              #   - adam: 1e-3 to 1e-4
                              #   - per_neuron (SequentialMLP): 1.0
                              #   - hybrid: see scaling_factor
  
  betas: [0.9, 0.999]         # Adam/hybrid beta parameters
  weight_decay: 0.0
  
  scaling_factor: -3          # For 'hybrid' optimizer only
                              # For 'per_neuron', auto-inferred from model.k if not specified
  
  # Training Dynamics
  grad_clip: 0.1
  verbose_interval: 10
  save_param_interval: 100

# Device
# ------
device: cuda                  # 'cuda' | 'cpu'

# Analysis & Visualization
# ------------------------
analysis:
  checkpoints: [0.0, 0.25, 0.5, 0.75, 1.0]  # Fraction of training for analysis
